<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>安全追溯监管理平台</title>
    <link rel="stylesheet" href="./public/dist/css/layui.css">
    <link rel="stylesheet" href="./css/index.css">
    <link rel="stylesheet" href="./public/font/iconfont.css">
    <link rel="icon" href="./public/favicon.ico">
    <script src="./js/index.js"></script>
    <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
    <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
</head>

<body class="layui-layout-body">
    <div class="index-top">
        <div class="index-topl">
            <div class="index-toplz">
                <p>服务交易</p>
                <span>欢迎 <label>黄焱（1053385537）</label>用户登录供应链协同管理平台，这是您的第 <i>10</i>次登录</span>
            </div>
        </div>
        <div class="index-topr">
            <div class="index-toprz">
                <div class="index-toprtex">认证状态：<span>（未录入）</span></div>
                <a href="javascript:;" class="two-in-message">
                    <i class="iconfont  icon-tishi" style="font-size:30px;color:#6F6C6C"></i>
                    <span class="layui-badge-dot"></span>
                </a>
                <div class="index-toprimg">
                    <img src="./img/colorr.png" alt="">
                </div>
                <div class="layui-nav-item two-in-data">
                    <a href="javascript:;">
                        管理员（admin）
                    </a>
                    <div></div>
                </div>
            </div>
        </div>
    </div>
    <div class="layui-layout layui-layout-admin">
        <div class="layui-header layui-bg-cyan">
            <div class="layui-logo two-in-logo">

            </div>
            <div class="layui-nav layui-layout-left two-in-title">
                <div class="nav-tabs">
                    <div class="nav-left">
                        <i class="iconfont icon-houtui nav-i"></i>
                    </div>
                    <div class="tabs">
                        <div class="tabs-con">
                            <div class="tabs-item tabs-item-this" data-src='./src/workbench.html' data-title="首页">
                                <div class="dot"></div>
                                首页
                            </div>
                            
                            
                        </div>
                    </div>
                    <div class="nav-r">
                        <div class="nav-right">
                            <i class="iconfont icon-kuaijin nav-i"></i>
                        </div>
                        <div class="nav-close">
                            <i class="iconfont icon-yuanxingdacha nav-i"></i>
                            <div class="nav-close-dialog">
                                <div class="nav-close-item" id='closeother'>关闭其他</div>
                                <div class="nav-close-item" id='closeall'>关闭所有</div>
                            </div>
                        </div>
                        <div class="nav-exit">
                            <i class="iconfont icon-tuichu nav-i"></i>
                            退出
                        </div>
                    </div>
                </div>
                <div class="nav-border">
                    <img src="./img/colorr.png" alt="">
                </div>
                <div class="nav-background">
                </div>
            </div>

           
        </div>
        <!-- 上/头部 -->
        <div class="layui-side layui-bg-cyan two-in-menu">
            <div class="layui-side-scroll">
                <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
                <ul class="layui-nav layui-nav-tree layui-bg-cyan two-in-menu" id="twoinmenu" lay-filter="navtest">
                    <li class="layui-nav-item two-in-menu-one">
                        <i class="iconfont icon-webicon01"></i>
                        <label style="cursor: pointer;">工作台</label>
                        <i class="iconfont icon-jiantousanjiaoxia"></i>
                    </li>
                    <!--加 layui-nav-itemed 张开 -->
                    <li class="layui-nav-item">&nbsp;</li>
                    <!-- <li class="layui-nav-item">
                        <a class="" href="javascript:;">
                            <i class="iconfont icon-ios-archive"></i> 我的工作
                        </a>
                        <dl class="layui-nav-child">
                            <dd>
                                <a href="javascript:;" data-options="{url:'../../index.html'}">列表一</a>
                            </dd>
                            <dd>
                                <a href="javascript:;" data-options="{url:'../vertical/Amywork/message.html',title:'列表er'}">列表er</a>
                            </dd>
                        </dl>
                    </li> -->
                </ul>
            </div>
        </div>

        <div class="layui-body two-in-con">
            <!-- 内容主体区域 -->
            <div style="padding:10px;" class="two-in-coms">
                <div class="work">
                    <img src="./img/bjt.png" alt="">
                </div>
                <div class="content">
                    <div class="title">
                        <div class="title-lt">工作台</div>
                        <div class="title-rt">工作台</div>
                    </div>

                    <div class="content-nav">
                        <div class="content-nav-item">
                            首页
                        </div>
                    </div>
                    <iframe scrolling="auto" src="" frameborder="0" id="contentsss" style="width:100%;height:100%;"></iframe>
                </div>
                
            </div>
        </div>
        <!-- 底部固定区域 -->
        <!-- <div class="layui-footer">
          
        </div> -->
    </div>
    <script src="../../public/dist/layui.js"></script>
    <script>

        getClientHeight();
        //动态给高
        function getClientHeight() {
            var clientHeight = 0;
            if (document.body.clientHeight && document.documentElement.clientHeight) {
                var clientHeight = (document.body.clientHeight < document.documentElement.clientHeight) ? document.documentElement.clientHeight : document.body.clientHeight;
            } else {
                var clientHeight = (document.body.clientHeight > document.documentElement.clientHeight) ? document.body.clientHeight : document.documentElement.clientHeight;
            }
            document.querySelector('.two-in-coms').style.height = clientHeight - 140 + 'px';
            return
        }


        //动态添加菜单
        var elms = "";
        for (let index = 0; index < menudata.length; index++) {
            var child = "";
            var meunchid = menudata[index].child;
            if (meunchid) {
                for (const i in meunchid) {
                    child +=
                        '<dl class="layui-nav-child">' +
                        '<dd><a href="javascript:;" data-options="' + meunchid[i].url + '"><i class="iconfont icon-wanggeshitu"></i>' + meunchid[i].title + '</a></dd>' +
                        '</dl>'
                }
            }
            elms += '<li class="layui-nav-item">' +
                '<a class="" href="javascript:;">' +
                '<i class="iconfont ' + menudata[index].icon + '"></i>' + menudata[index].title + '</a >' +
                child +
                '</li>'
        }
        document.querySelector("#twoinmenu").innerHTML += elms;
        document.querySelector(".two-in-menu ul>li:last-child").setAttribute("lay-unselect", "");

        // 左侧菜单
        layui.use('element', function () {
            
            var $ = layui.$,
                element = layui.element;
            element.init();
            element.on('nav(navtest)', function (elem) {
                // var navfrist = 
                var cun = elem[0].dataset.options;
                // 添加导航
                if (cun != undefined) {
                    $("#contentsss").attr("src", cun);
                    // var navItem = '<div class="tabs-item"><div class="dot"></div>'
                    // +elem.context.innerText
                    // +'<div class="tabs-close">×</div></div>'
                    tabsItem = document.querySelectorAll('.tabs-item');
                    
                    for(var i=0;i<tabsItem.length;i++){
                        var src = tabsItem[i].getAttribute('data-src');
                        if(src == cun){
                            document.querySelector('.tabs-item-this').classList.remove('tabs-item-this');
                            tabsItem[i].classList.add('tabs-item-this');
                            document.querySelector('.content-nav-item').innerHTML = tabsItem[i].getAttribute('data-title')
                            return;
                        }
                    }
                    if(document.querySelector('.tabs-item-this')&&document.querySelector('.tabs-item-this')!=''){
                        document.querySelector('.tabs-item-this').classList.remove('tabs-item-this');

                    }
                    var navItem=document.createElement('div');
                    navItem.setAttribute('class','tabs-item');
                    navItem.classList.add('tabs-item-this')
                    navItem.setAttribute('data-src',cun);
                    navItem.setAttribute('data-title',elem.context.innerText);
                    document.querySelector('.content-nav-item').innerHTML = elem.context.innerText
                    navItem.innerHTML = '<div class="dot"></div>'
                    +elem.context.innerText
                    +'<div class="tabs-close">×</div>';
                    document.querySelector('.tabs-con').appendChild(navItem);

                    tabsItem = document.querySelectorAll('.tabs-item');
                    chooseNavItem();
                    navItemClose();
                }
            });
            element.render('nav');


        });
    </script>


</body>
<script>
    // 左右滑动导航
    var moveLeft = document.querySelector('.nav-left');
    var moveRight = document.querySelector('.nav-right');
    var tabsCon = document.querySelector('.tabs-con');
    var left = 0;
    moveLeft.addEventListener('click', function () {
        if (left < -200) {
            left = left + 200;
        } else {
            left = 0
        }
        tabsCon.style.left = left + 'px';
    })
    moveRight.addEventListener('click', function () {
        var tabs = document.querySelector('.tabs');
        tabsW = tabs.clientWidth||tabs.offsetWidth;
        tabsCon = document.querySelector('.tabs-con'); 
        tabsConW = tabsCon.clientWidth||tabsCon.offsetWidth;
        if(tabsConW>(tabsW-left)){
            left = left - 200;
            tabsCon.style.left = left + 'px';
        }
        // var tabsConW = tabsCon.clientWidth||tabsCon.offsetWidth;
        // tabsConW = tabsConW - 200;
        // tabsConW = 0-tabsConW
        
    })
    // 选择导航页面
    chooseNavItem();
    function chooseNavItem(){
        var tabsItem = document.querySelectorAll('.tabs-item');
        for(var i=0;i<tabsItem.length;i++){
            (function(i){
                tabsItem[i].addEventListener('click',function(){
                    document.querySelector('.tabs-item-this').classList.remove('tabs-item-this');
                    tabsItem[i].classList.add('tabs-item-this');
                    var src = tabsItem[i].getAttribute('data-src');
                    var title = tabsItem[i].getAttribute('data-title');
                    document.getElementById('contentsss').setAttribute("src", src);
                    document.querySelector('.content-nav-item').innerHTML = tabsItem[i].getAttribute('data-title');
                    navActive(i)
                    navItemClose();
                })
            })(i)
        }
    }
    // 关闭导航页面
    navItemClose();
    function navItemClose(){
        var navItemClose = document.querySelectorAll('.tabs-close');
        var tabsItem = document.querySelectorAll('.tabs-item');
        for(var i=0;i<navItemClose.length;i++){
            (function(i){
                navItemClose[i].addEventListener('click',function(ev){
                    this.parentNode.remove();
                    
                    navItemClose = document.querySelectorAll('.tabs-close');
                    tabsItem = document.querySelectorAll('.tabs-item');
                    if(!document.querySelector('.tabs-item-this')){
                        // document.querySelector('.tabs-item-this').classList.remove('tabs-item-this');
                        tabsItem[i].classList.add('tabs-item-this');
                        var src = tabsItem[i].getAttribute('data-src')
                        document.querySelector('.content-nav-item').innerHTML = tabsItem[i].getAttribute('data-title')
                        document.getElementById('contentsss').setAttribute("src", src);
                        navActive(i)
                    }
                    stopBubble(ev);
                })
            })(i)
        }
    }
    // 选择顶部导航控住左边导航活动
    function navActive(i){
        var navChild = document.querySelectorAll('.layui-nav-child>dd>a');
        var navCd = document.querySelectorAll('.layui-nav-child>dd');
        var navItemed = document.querySelectorAll('.layui-nav-itemed');
        for(var k=0;k<navItemed.length;k++){
            navItemed[k].classList.remove('layui-nav-itemed');
        }
        if(document.querySelector('.layui-this')){
            document.querySelector('.layui-this').classList.remove('layui-this');
        }
        for(var j=0;j<navChild.length;j++){
            if(tabsItem[i].getAttribute('data-title') == navChild[j].innerText){
                navCd[j].classList.add('layui-this');
                navCd[j].parentNode.parentNode.classList.add('layui-nav-itemed');
            }
        }
    }
    // 禁止冒泡事件
    function stopBubble(e) {
        //如果提供了事件对象，则这是一个非IE浏览器
    if ( e && e.stopPropagation )
        //因此它支持W3C的stopPropagation()方法
        e.stopPropagation();
    else
    //否则，我们需要使用IE的方式来取消事件冒泡
        window.event.cancelBubble = true;
    }


    var navClose = document.querySelector('.nav-close');
    var navCloseDialog = document.querySelector('.nav-close-dialog');
    var closeOther = document.querySelector('#closeother');
    var closeAll = document.querySelector('#closeall');
    var indexNav = '<div class="tabs-item tabs-item-this" data-src="./src/workbench.html" data-title="首页"><div class="dot"></div>首页</div>';
    var tabsCon = document.querySelector('.tabs-con');

    navClose.addEventListener('mouseover',function(){
        navCloseDialog.style.display = 'block'
    })
    navClose.addEventListener('mouseout',function(){
        navCloseDialog.style.display = 'none'
    })
    // 关闭所有
    closeAll.addEventListener('click',function(){
        navCloseDialog.style.display = 'none';
        tabsCon.innerHTML = indexNav;
        document.getElementById('contentsss').setAttribute("src", './src/workbench.html');
        document.querySelector('.content-nav-item').innerHTML = '首页';
        var navItemed = document.querySelectorAll('.layui-nav-itemed');
        for(var k=0;k<navItemed.length;k++){
            navItemed[k].classList.remove('layui-nav-itemed');
        }
        if(document.querySelector('.layui-this')){
            document.querySelector('.layui-this').classList.remove('layui-this');
        }
        chooseNavItem();
        navItemClose();
    })
    // 关闭其他
    closeOther.addEventListener('click',function(){
        var tabsThis = document.querySelector('.tabs-item-this');
        
        var indexNavInner = '<div class="dot"></div>首页';
        navCloseDialog.style.display = 'none';
        if(tabsThis.getAttribute('data-src')=='./src/workbench.html'){
            tabsCon.innerHTML = indexNav;
        }else{
            tabsCon.innerHTML = '<div class="tabs-item" data-src="./src/workbench.html" data-title="首页"><div class="dot"></div>首页</div>'+'<div class="tabs-item tabs-item-this" data-src="'
            +tabsThis.getAttribute('data-src')
            +'" data-title="'
            +tabsThis.getAttribute('data-title')
            +'">'
            +tabsThis.innerHTML
            +'</div>';
        }
        document.querySelector('.content-nav-item').innerHTML = document.querySelector('.tabs-item-this').getAttribute('data-title');
        chooseNavItem();
        navItemClose();
    })
    // 工作台
    selectIndexNav();
    function selectIndexNav(){
        document.querySelector('.two-in-menu-one').addEventListener('click',function(){
            var tabsItem = document.querySelectorAll('.tabs-item');
            document.querySelector('.tabs-item-this').classList.remove('tabs-item-this');
            tabsItem[0].classList.add('tabs-item-this');
            document.getElementById('contentsss').setAttribute("src", './src/workbench.html');
            document.querySelector('.content-nav-item').innerHTML = '首页';
            if(document.querySelector('.layui-this')){
                document.querySelector('.layui-this').classList.remove('layui-this');
            }
        })
    }
</script>

</html>